
"use strict"




var analyseData       = require('hacker-news/stats/analyse-data')
var findTermFrequency = require('hacker-news/stats/find-term-frequency')




var addTimeLabel = ({year, month}, freq) => {

	if (year) {
		freq.datum.timeLabel = new Date(freq.datum.time).getFullYear( )
	}

	if (month) {
		freq.datum.timeLabel = new Date(freq.datum.time).getMonth( )
	}

	return freq

}





var main = rawArgs => {

	var args = main.validate(main.preprocess(rawArgs))

	if (args.freq) {

		analyseData(args, data => {

			findTermFrequency(args, data, freqs => {

				var groups = freqs
					.map(freq => {

						return addTimeLabel({
							year:  args.year,
							month: args.month
						}, freq)

					})
					.reduce((acc, freq) => {

					})

			})

		})

	}

}

main.validate = rawArgs => {
	return rawArgs
}

main.preprocess = rawArgs => {

	var args = {
		freq:    rawArgs.freq,
		phrases: rawArgs['<phrase>'],
		year:    rawArgs['-y'] || rawArgs['--year'],
		month:   rawArgs['-m'] || rawArgs['--month']
	}

	return args

}





module.exports = main
