
"use strict"




var analyseData         = require('hacker-terms/stats/analyse-data')
var findTermFrequency   = require('hacker-terms/stats/find-term-frequency')
var averageUsageInRange = require('hacker-terms/stats/average-usage-in-range')





var main = rawArgs => {

	var args = main.validate(main.preprocess(rawArgs))

	if (args.freq) {

		analyseData(args, data => {

			findTermFrequency(args, data, freqs => {

				var usage = averageUsageInRange(args, freqs)
				console.log( usage )

			})

		})

	}

}

main.validate = rawArgs => {
	return rawArgs
}

main.preprocess = rawArgs => {

	return {
		freq:    rawArgs.freq,
		phrases: rawArgs['<phrase>'],
		year:    rawArgs['-y'] || rawArgs['--year'],
		month:   rawArgs['-m'] || rawArgs['--month']
	}

}





module.exports = main
