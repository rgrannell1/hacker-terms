
"use strict"




var is        = require('is')

var readline  = require('readline')
var fs        = require('fs')
var constants = require('hacker-terms/commons/constants')




var collectData = (args, predicate, callback) => {

	var ith   = 0
	var data  = [ ]

	readline.createInterface({
		input: process.stdin
	})
	.on('line', line => {

		var json = JSON.parse(line)

		if (predicate(json)) {

			data.push({
				title: json.body.title,
				score: json.body.score,
				time:  json.body.time
			})

		}

	})
	.on('close', ( ) => {
		callback(data)
	})

}





var analyseData = (args, callback) => {

	collectData(args, json => {
		return json.body && is.string(json.body.title) && json.body.score && json.body.type === 'story'
	}, callback)

}





module.exports = analyseData
